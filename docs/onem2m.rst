==============
oneM2M (HTTP)
==============

디바이스에서 생성된 데이터를 oneM2M 표준을 이용하여 저장/조회하는 기능을 소개합니다.

* `데이터 생성`_
* `데이터 조회`_
* `참고 문서 또는 사이트`_

.. tip::
    MEDBIZ 플랫폼에 제품을 등록하기 위해 등록에 필요한 정보를 미리 준비해주세요.


.. contents:: 목차

-------------
데이터 생성
-------------

.. table::
  :widths: auto

  =========================  =================================================================
  내용
  =========================  =================================================================
  HTTP Request Method        POST
  -------------------------  -----------------------------------------------------------------
  HTTP Request URL           :code:`https://onem2m.medbiz.or.kr/Mobius/<Device_ID>/fields/<field>`
  -------------------------  -----------------------------------------------------------------
  Header                     .. code:: json

                                     {
                                       "Accept" : "application/json",
                                       "X-M2M-Origin" : "<Device_SECRET>",
                                       "Content-Type" : "application/json;ty=4",
                                       "X-M2M-RI" : "<Resource Identifier>"
                                     }

  -------------------------  -----------------------------------------------------------------
  Body                       .. code:: json

                                     {
                                       "m2m:cin": {
                                         "con": 27.00
                                       }
                                     }

  -------------------------  -----------------------------------------------------------------
  Response                   .. code:: json

                                     {
                                       "m2m:cin": {
                                         "rn": "4-20180919070519631uP5z",
                                         "ty": 4,
                                         "pi": "{parentID}",
                                         "ri": "{resourceID}",
                                         "ct": "20180919T070519",
                                         "et": "20210919T070519",
                                         "lt": "20180919T070519",
                                         "st": 0,
                                         "cs": 2,
                                         "con": "27",
                                         "cr": "S20170717074825768bp2l"
                                       }
                                     }

  =========================  =================================================================

*  파라미터 설명

   - <Device_ID> : 디바이스 MUID 값을 대입
   - <Device_SECRET> : 디바이스 Token 값을 대입
   - <Resource Identifier> : 리소스 ID 요청하는 값에 대해 응답에 해당값을 포함시켜줌 (비동기 요청에서 동일한 요청-응답 확인을 위함) HTTP 사용시 8자 이하의 ASCII 문자 권장
   - <field> : manifest에 등록되어있는 디바이스 필드 값 (디바이스 생성시 생성되어있음)


------------
데이터 조회
------------

최근 1건
============

.. table::
  :widths: auto

  =========================  =================================================================
  내용
  =========================  =================================================================
  HTTP Request Method        GET
  -------------------------  -----------------------------------------------------------------
  HTTP Request URL           :code:`https://onem2m.medbiz.or.kr/Mobius/<Device_ID>/fields/<field>/latest`
  -------------------------  -----------------------------------------------------------------
  Header                     .. code:: json

                                     {
                                       "Accept" : "application/json",
                                       "X-M2M-Origin" : "<Device_SECRET>"
                                       "X-M2M-RI" : "<Resource Identifier>"
                                     }

  -------------------------  -----------------------------------------------------------------
  Response                   .. code:: json

                                 {
                                   "m2m:cin": {
                                     "rn": "4-20180919070519631uP5z",
                                     "ty": 4,
                                     "pi": "{parentID}",
                                     "ri": "{resourceID}",
                                     "ct": "20180919T070519",
                                     "et": "20210919T070519",
                                     "lt": "20180919T070519",
                                     "st": 0,
                                     "cs": 2,
                                     "con": "27",
                                     "cr": "S20170717074825768bp2l"
                                   }
                                 }

  =========================  =================================================================

기간 검색
====================

.. table::
  :widths: auto

  =========================  =================================================================
  내용
  =========================  =================================================================
  HTTP Request Method        GET
  -------------------------  -----------------------------------------------------------------
  HTTP Request URL           :code:`https://onem2m.medbiz.or.kr/Mobius/<Device_ID>/fields/<field>`
  -------------------------  -----------------------------------------------------------------
  Header                     .. code:: json

                                     {
                                       "Accept" : "application/json",
                                       "X-M2M-Origin" : "<Device_SECRET>"
                                       "X-M2M-RI" : "<Resource Identifier>"
                                     }

  -------------------------  -----------------------------------------------------------------
  Params
                               - **rcn**
                               쿼리 범위
                               하위 리소스 이므로 4 로 명시

                               - **ty**
                               resource type
                               content instance (생성한 데이터) 이므로 4 로 명시

                               - **cra**
                               created after
                               생성 조회 시작일 UTC 시간임을 유의
                               20191112T000000

                               - **crb**
                               created before
                               생성 조회 마감일 UTC 시간임을 유의
                               20191120T235959

  -------------------------  -----------------------------------------------------------------
  Response                   .. code:: json

                                 {
                                  "m2m:rsp": {
                                    "m2m:cin": {
                                      "rn": "4-20180919070519631uP5z",
                                      "ty": 4,
                                      "pi": "{parentID}",
                                      "ri": "{resourceID}",
                                      "ct": "20180919T070519",
                                      "et": "20210919T070519",
                                      "lt": "20180919T070519",
                                      "st": 0,
                                      "cs": 2,
                                      "con": "27",
                                      "cr": "S20170717074825768bp2l"
                                    }
                                  }
                                }

  =========================  =================================================================

--------------------------------------------------
참고 문서 또는 사이트
--------------------------------------------------

.. table::
 :widths: auto

 =========  ===================================================================
 자료명     관련 참조
 ---------  -------------------------------------------------------------------
 oneM2M     http://www.onem2m.org/application-developer-guide/architecture
 =========  ===================================================================
